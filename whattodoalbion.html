<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <title>What to Do Albion</title>
    <style>
        body {
            background-color: black;
            color: white;
        }

        h5 {
            text-align: center;
        }

        #btnRow {
            display: flex;
            justify-content: space-between;
        }

        .container {
            margin-top: 2%;
        }

        #item:hover,
        #price:hover {
            cursor: pointer;
        }

        /* The switch - the box around the slider */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        /* Hide default HTML checkbox */
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        /* The slider */
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }

        input:checked+.slider {
            background-color: #2196F3;
        }

        input:focus+.slider {
            box-shadow: 0 0 1px #2196F3;
        }

        input:checked+.slider:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="row" id="btnRoww">
            <div class="col" id="btnRow">
                <button type="button" class="btn btn-primary" onclick="ShowData()" id="whereToEatBtn">做什麼</button>
                <button type="button" class="btn btn-danger" onclick="RandomFood()"
                    style="visibility: hidden;">換一個</button>
                <!-- <div class="custom-control custom-switch">
                    <input type="checkbox" class="custom-control-input" id="customSwitch1" onclick="SwitchTheme()">
                    <label class="custom-control-label" for="customSwitch1">切換主題</label>
                </div> -->
                <label class="switch">
                    <input type="checkbox" id="customSwitch1" onclick="SwitchTheme()">
                    <span class="slider round"></span>
                </label>
            </div>
        </div>

        <div class="row" id="h5Row">
            <div class="col">
                <h5></h5>
            </div>
        </div>

        <div class="row">
            <div class="col">
                <table class="table table-striped" id="myTable">
                    <thead>
                        <tr>
                            <th id="item">編號</th>
                            <th id="price">活動</th>
                        </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Bootstrap Required -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script>
        let tbody = document.querySelector('tbody');
        let data = [
            {
                "name": "打架",
                "menu": [
                    {
                        "dish": "1",
                        "price": "1 VS 1"
                    },
                    {
                        "dish": "2",
                        "price": "2 VS 2"
                    },
                    {
                        "dish": "3",
                        "price": "腐蝕地下城(黃洞)"
                    },
                    {
                        "dish": "4",
                        "price": "綠洞"
                    },
                    {
                        "dish": "5",
                        "price": "藍洞"
                    },
                    {
                        "dish": "6",
                        "price": "競技場"
                    },
                    {
                        "dish": "7",
                        "price": "遠征"
                    },
                    {
                        "dish": "8",
                        "price": "阿瓦隆"
                    },
                    {
                        "dish": "9",
                        "price": "陣營戰"
                    },
                ]
            },
            {
                "name": "採集",
                "menu": [
                    {
                        "dish": "1",
                        "price": "獸皮"
                    },
                    {
                        "dish": "2",
                        "price": "採礦"
                    },
                    {
                        "dish": "3",
                        "price": "釣魚"
                    },
                    {
                        "dish": "4",
                        "price": "木材"
                    },
                    {
                        "dish": "5",
                        "price": "石頭"
                    },
                    {
                        "dish": "6",
                        "price": "棉花"
                    }
                ]
            },
            {
                "name": "工人",
                "menu": [
                    {
                        "dish": "1",
                        "price": "獸皮"
                    },
                    {
                        "dish": "2",
                        "price": "採礦"
                    },
                    {
                        "dish": "3",
                        "price": "釣魚"
                    },
                    {
                        "dish": "4",
                        "price": "木材"
                    },
                    {
                        "dish": "5",
                        "price": "石頭"
                    },
                    {
                        "dish": "6",
                        "price": "棉花"
                    }
                ]
            },
        ];

        var clickedCount = 0;
        function ShowData() {
            tbody.innerHTML = "";
            let random = Math.floor(Math.random() * data.length); //0 to 9
            let h5 = document.querySelector('h5');
            h5.innerText = data[random].name;

            for (let i = 0; i < data[random].menu.length; i++) { //品項
                let tbodyTr = document.createElement('tr');
                tbodyTr.className = 'foodTr';
                let td = document.createElement('td');
                td.innerHTML = data[random].menu[i].dish;
                tbodyTr.appendChild(td);

                let td2 = document.createElement('td'); //價格
                td2.innerHTML = data[random].menu[i].price;
                tbodyTr.appendChild(td2);
                tbody.appendChild(tbodyTr);
            }

            $(".btn-danger").css("visibility", "visible");
            clickedCount = 0;
            RandomFood();
            clickedCount = 0;

            let blueBtn = document.querySelector('.btn-primary');
            blueBtn.innerText = '換一種';

            let item = document.getElementById('item');
            // let price = document.getElementById('price');
            item.addEventListener('click', function () {
                SortByName();
            });
            // price.addEventListener('click', function () {
            //     SortByPrice();
            // });
        }

        function RandomFood() {
            let trs = document.querySelectorAll(".foodTr");
            let random = Math.floor(Math.random() * trs.length); //0 to 9
            trs.forEach(element => {
                element.style.backgroundColor = null;
            });

            let tr = document.querySelectorAll('tr');
            tr.forEach(element => {
                element.style.backgroundColor = null;
            });

            if (trs.length != 0) {
                let theTr = trs[random];
                theTr.style.backgroundColor = 'red';
                theTr.className = 'marked';
            }

            clickedCount++;
            if (trs.length == 0) {
                alert('你真他媽挑欸，刪遊戲吧!');
                ShowData();
            }
        }
    </script>

    <script>
        function SortByName() {
            var table, rows, switching, i, x, y, shouldSwitch;
            table = document.getElementById("myTable");
            switching = true;
            /* Make a loop that will continue until
            no switching has been done: */
            while (switching) {
                // Start by saying: no switching is done:
                switching = false;
                rows = table.rows;
                /* Loop through all table rows (except the
                first, which contains table headers): */
                for (i = 1; i < (rows.length - 1); i++) {
                    // Start by saying there should be no switching:
                    shouldSwitch = false;
                    /* Get the two elements you want to compare,
                    one from current row and one from the next: */
                    x = rows[i].getElementsByTagName("TD")[0];
                    y = rows[i + 1].getElementsByTagName("TD")[0];
                    // Check if the two rows should switch place:
                    if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                        // If so, mark as a switch and break the loop:
                        shouldSwitch = true;
                        break;
                    }
                }
                if (shouldSwitch) {
                    /* If a switch has been marked, make the switch
                    and mark that a switch has been done: */
                    rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                    switching = true;
                }
            }
        }
    </script>

    <script>
        window.onload = function SortByPrice() {
            var oTable = document.getElementById('myTable');
            var oTbody = oTable.tBodies[0];
            var oBtn = document.getElementById('price');
            var arr = [];//用來存放每一個tr
            var isAsc = true;//用來判斷升序,還是降序
            oBtn.onclick = function () {
                for (var i = 0; i < oTbody.rows.length; i++) {
                    arr[i] = oTbody.rows[i];//這裡是把每一個tr存放到一個數組,而不是排序的依據(這裡是cells[0].innerHTML)
                }
                //陣列根據cells[0].innerHTML來排序
                arr.sort(function (td1, td2) {
                    if (isAsc) {
                        return parseInt(td1.cells[1].innerHTML) - parseInt(td2.cells[1].innerHTML);
                    } else {
                        return parseInt(td2.cells[1].innerHTML) - parseInt(td1.cells[1].innerHTML);
                    }
                });
                //把排序後的tr 重新插入tbody
                for (var j = 0; j < arr.length; j++) {
                    oTbody.appendChild(arr[j]);
                }
                //判斷升序,降序
                isAsc = !isAsc;
            }
        }
    </script>

    <script>
        function SwitchTheme() {
            let sch = document.getElementById('customSwitch1');
            if (sch.checked == true) {
                $('body').css('background-color', '#C7EDCC');
                $('body').css('color', 'black');
            }
            else {
                $('body').css('background-color', 'black');
                $('body').css('color', 'white');
            }
        }
    </script>
</body>

</html>